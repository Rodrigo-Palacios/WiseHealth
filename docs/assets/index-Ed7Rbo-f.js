(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function e(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(t){if(t.ep)return;t.ep=!0;const n=e(t);fetch(t.href,n)}})();function q(l){let o=parseInt(l);const e=I();console.log(o);let c=e.findIndex(t=>t.id===o);e.splice(c,1),localStorage.setItem("list",JSON.stringify(e)),U()}function L(l){let o=l.slice(0,1).toUpperCase(),e=l.slice(1);return`${o}${e}`}function w(l){return`$${l/1e6}M`}function A(l){return`${l*100}%`}function M(l){return`$${l/1e3}K`}const P={selectedPlan:!1,containerPlan:null,ulCheck:null,btnClick:null};function k(){document.getElementById("containerTarifas").addEventListener("click",o=>{const e=o.target.dataset.planId,c=`card${L(e)}`,t=`ul${L(e)}`,n=document.querySelector(`.btn${e}`),r=document.querySelector(`.${c}`),m=document.getElementById(`${t}`).querySelectorAll("span");if(P.selectedPlan){document.querySelector(`.${P.containerPlan}`).classList.remove("cardSelected"),document.getElementById(`${P.ulCheck}`).querySelectorAll("span").forEach(b=>{b.classList.remove("checkSelected")});const s=document.querySelector(`${P.btnClick}`);s.textContent="Seleccionar",s.classList.remove("btnSelected")}r.classList.add("cardSelected"),P.containerPlan=c,P.ulCheck=t,m.forEach(i=>{i.classList.add("checkSelected")}),n.textContent="Seleccionado",n.classList.add("btnSelected"),P.btnClick=`.btn${e}`,P.selectedPlan=!0})}new URL("./assets/check_green.svg",import.meta.url).href;function j(l){const o=document.getElementById("tarifas");if(document.getElementById("headerTarifas")){document.getElementById("tarifas").textContent="";const e=document.createElement("div");e.id="headerTarifas";const c=document.createElement("h2");c.textContent="Elige tu cobertura ideal",e.appendChild(c);const t=document.createElement("p");t.textContent="Compara los beneficios y selecciona el plan que mejor se adapte a ti.",e.appendChild(t),o.appendChild(e);const n=document.createElement("div");n.id="containerTarifas",o.appendChild(n),l.forEach(s=>{const b={optimo:"Óptimo",premium:"Premium",esencial:"Esencial"},h=L(s.plan),a=document.createElement("div");a.classList.add(`card${h}`),n.appendChild(a);const C=document.createElement("div");C.id=s.plan;const y=document.createElement("h2");y.id=`h2${h}`,y.textContent=`${b[s.plan]}`,C.appendChild(y),a.appendChild(C);const g=document.createElement("div");g.id=`preci${h}`;const $=document.createElement("span");$.textContent=O(s.items[4].value);const S=document.createElement("span");S.textContent=" /año",g.appendChild($),g.appendChild(S),a.appendChild(g);const x=document.createElement("ul");x.id=`ul${h}`,a.appendChild(x),s.items.forEach(d=>{if(d.label==="Costo anual")return;const T=document.createElement("li");let E=d.value;d.label==="Suma asegurada"&&(E=w(d.value)),d.label==="Deducible"&&(E=`${d.value} UMAM`),d.label==="Coaseguro"&&(E=A(d.value)),d.label==="Tope coaseguro"&&(E=M(d.value)),T.innerHTML=`
                <span class="check_marck"></span>${d.label}: <strong>${E}</strong>
                `,x.appendChild(T)});const v=document.createElement("button");v.classList.add("btnPlan"),v.classList.add(`btn${s.plan}`),v.dataset.planId=s.plan,v.textContent="Seleccionar",a.appendChild(v)});const r=document.getElementById("optimo"),f=document.getElementById("premium"),m=document.getElementById("esencial"),i=document.createElement("p");i.id="pOptimo",i.textContent="Balance costo-beneficio.";const p=document.createElement("p");p.id="pPremium",p.textContent="Máxima protección posible.";const u=document.createElement("p");u.id="pEsencial",u.textContent="Protección básica vital.",r.appendChild(i),f.appendChild(p),m.appendChild(u),k()}else{const e=document.createElement("div");e.id="headerTarifas";const c=document.createElement("h2");c.textContent="Elige tu cobertura ideal",e.appendChild(c);const t=document.createElement("p");t.textContent="Compara los beneficios y selecciona el plan que mejor se adapte a ti.",e.appendChild(t),o.appendChild(e);const n=document.createElement("div");n.id="containerTarifas",o.appendChild(n),l.forEach(s=>{const b={optimo:"Óptimo",premium:"Premium",esencial:"Esencial"},h=L(s.plan),a=document.createElement("div");a.classList.add(`card${h}`),n.appendChild(a);const C=document.createElement("div");C.id=s.plan;const y=document.createElement("h2");y.id=`h2${h}`,y.textContent=`${b[s.plan]}`,C.appendChild(y),a.appendChild(C);const g=document.createElement("div");g.id=`preci${h}`;const $=document.createElement("span");$.textContent=O(s.items[4].value);const S=document.createElement("span");S.textContent=" /año",g.appendChild($),g.appendChild(S),a.appendChild(g);const x=document.createElement("ul");x.id=`ul${h}`,a.appendChild(x),s.items.forEach(d=>{if(d.label==="Costo anual")return;const T=document.createElement("li");let E=d.value;d.label==="Suma asegurada"&&(E=w(d.value)),d.label==="Deducible"&&(E=`${d.value} UMAM`),d.label==="Coaseguro"&&(E=A(d.value)),d.label==="Tope coaseguro"&&(E=M(d.value)),T.innerHTML=`
                <span class="check_marck"></span>${d.label}: <strong>${E}</strong>
                `,x.appendChild(T)});const v=document.createElement("button");v.classList.add(`btn${s.plan}`),v.dataset.planId=s.plan,v.textContent="Seleccionar",a.appendChild(v)});const r=document.getElementById("optimo"),f=document.getElementById("premium"),m=document.getElementById("esencial"),i=document.createElement("p");i.id="pOptimo",i.textContent="Balance costo-beneficio.";const p=document.createElement("p");p.id="pPremium",p.textContent="Máxima protección posible.";const u=document.createElement("p");u.id="pEsencial",u.textContent="Protección básica vital.",r.appendChild(i),f.appendChild(p),m.appendChild(u),k()}}const O=l=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",maximumFractionDigits:2}).format(l),N="https://wisehealth-api.vercel.app";async function H(l){const e=l.map(a=>({edad:Number(a.age),genero:String(a.gender).trim()})),c=await fetch(`${N}/api/cotizar`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({personas:e})}),n=await(await fetch(`${N}/api/planes`,{method:"GET",headers:{Accept:"application/json"}})).json(),r=await c.json(),f=Array.isArray(r.items)?r.items:[],m=Array.isArray(n.item)?n.item:[],i=new Map(m.map(a=>[a.plan,a])),p=f.map(a=>{const C=i.get(a.plan)||{};return{...a,...C}}),u=new Map(p.map(a=>[a.plan,a])),s=["optimo","premium","esencial"],b=[{label:"Suma asegurada",key:"suma_asegurada",type:"moneda"},{label:"Deducible",key:"deducible",type:"uma"},{label:"Coaseguro",key:"coaseguro",type:"porcentaje"},{label:"Tope coaseguro",key:"tope_coaseguro",type:"moneda"},{label:"Costo anual",key:"total",type:"moneda"}];let h=[];for(let a of s){const C=u.get(a);let y={plan:a,items:[]};for(let g of b)y.items.push({label:g.label,type:g.type,value:C[g.key]});h.push(y)}j(h)}const D="/WiseHealth/".endsWith("/")?"/WiseHealth/":"/WiseHealth//";function I(){const l=localStorage.getItem("list");return l?JSON.parse(l):[]}function U(){if(document.getElementById("tablePeople")){const l=document.getElementById("tableBody");l.innerHTML="";const o=I();if(o.length===0){const e=document.createElement("tr");e.innerHTML=`
      <td colspan="6">No hay personas registradas</td>
      `,l.appendChild(e)}o.forEach(e=>{const c=document.createElement("tr"),t=document.createElement("td"),n=document.createElement("td"),r=document.createElement("td"),f=document.createElement("td"),m=document.createElement("button");m.setAttribute("data-id",`${e.id}`),m.setAttribute("type","button"),t.textContent=`${e.name}`,n.textContent=`${e.age}`,r.textContent=`${e.gender}`,m.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>
      `,c.appendChild(t),c.appendChild(n),c.appendChild(r),f.appendChild(m),c.appendChild(f),l.appendChild(c)}),H(o)}else{document.getElementById("personList").setAttribute("id","personListStyle");const o=document.getElementById("info"),e=document.createElement("div");e.classList.add("headerSection");const c=document.createElement("img");c.src=D+"group.svg",c.alt="group_svg",c.id="group_svg";const t=document.createElement("h2");t.textContent="Personas en tu poliza";const n=document.createElement("table");n.setAttribute("id","tablePeople");const r=document.createElement("thead"),f=document.createElement("tbody");f.setAttribute("id","tableBody"),n.appendChild(r),n.appendChild(f),f.addEventListener("click",i=>{const p=i.target.closest("button");if(p){let u=p.dataset.id;q(u)}}),r.innerHTML=`
    <tr>
      <th>Nombre</th>
      <th>Edad</th>
      <th>Género</th>
      <th>Eliminar</th>
    </tr>
    `;const m=I();m.forEach(i=>{const p=document.createElement("tr"),u=document.createElement("td"),s=document.createElement("td"),b=document.createElement("td"),h=document.createElement("td"),a=document.createElement("button");a.setAttribute("data-id",`${i.id}`),a.setAttribute("type","button"),u.textContent=`${i.name}`,s.textContent=`${i.age}`,b.textContent=`${i.gender}`,a.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>
      `,p.appendChild(u),p.appendChild(s),p.appendChild(b),h.appendChild(a),p.appendChild(h),f.appendChild(p)}),e.appendChild(c),e.appendChild(t),o.appendChild(e),o.appendChild(n),H(m)}}const _=document.getElementById("buttonForm");class B{constructor(o,e,c){this.id=B.#e++,this.name=o,this.age=e,this.gender=c}static#e=Date.now()}_.addEventListener("click",l=>{l.preventDefault();let o=I(),e=document.forms.newPerson,c=e.name.value,t=e.age.value,n=e.gender.value;e.reportValidity()&&(o.push(new B(c,t,n)),localStorage.setItem("list",JSON.stringify(o)),e.reset()),U()});
