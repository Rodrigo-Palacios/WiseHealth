(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}})();function k(l){let o=parseInt(l);const e=w();console.log(o);let c=e.findIndex(n=>n.id===o);e.splice(c,1),localStorage.setItem("list",JSON.stringify(e)),H()}function L(l){let o=l.slice(0,1).toUpperCase(),e=l.slice(1);return`${o}${e}`}function B(l){return`$${l/1e6}M`}function A(l){return`${l*100}%`}function M(l){return`$${l/1e3}K`}new URL("./assets/check_green.svg",import.meta.url).href;function U(l){const o=document.getElementById("tarifas");if(document.getElementById("headerTarifas")){document.getElementById("tarifas").textContent="";const e=document.createElement("div");e.id="headerTarifas";const c=document.createElement("h2");c.textContent="Elige tu cobertura ideal",e.appendChild(c);const n=document.createElement("p");n.textContent="Compara los beneficios y selecciona el plan que mejor se adapte a ti.",e.appendChild(n),o.appendChild(e);const a=document.createElement("div");a.id="containerTarifas",o.appendChild(a),l.forEach(r=>{const v={optimo:"Óptimo",premium:"Premium",esencial:"Esencial"},m=L(r.plan),t=document.createElement("div");t.id=`card${m}`,a.appendChild(t);const E=document.createElement("div");E.id=r.plan;const b=document.createElement("h2");b.id=`h2${m}`,b.textContent=`${v[r.plan]}`,E.appendChild(b),t.appendChild(E);const g=document.createElement("div");g.id=`preci${m}`;const P=document.createElement("span");P.textContent=S(r.items[4].value);const T=document.createElement("span");T.textContent=" /año",g.appendChild(P),g.appendChild(T),t.appendChild(g);const x=document.createElement("ul");x.id=`ul${m}`,t.appendChild(x),r.items.forEach(d=>{if(d.label==="Costo anual")return;const $=document.createElement("li");let C=d.value;d.label==="Suma asegurada"&&(C=B(d.value)),d.label==="Deducible"&&(C=`${d.value} UMAM`),d.label==="Coaseguro"&&(C=A(d.value)),d.label==="Tope coaseguro"&&(C=M(d.value)),$.innerHTML=`
                <span class="check_marck"></span>${d.label}: <strong>${C}</strong>
                `,x.appendChild($)});const y=document.createElement("button");y.classList.add("btnPlan"),y.textContent="Seleccionar",y.value=v[r.plan],t.appendChild(y),console.log(y.value)});const s=document.getElementById("optimo"),h=document.getElementById("premium"),f=document.getElementById("esencial"),p=document.createElement("p");p.id="pOptimo",p.textContent="Balance costo-beneficio.";const i=document.createElement("p");i.id="pPremium",i.textContent="Máxima protección posible.";const u=document.createElement("p");u.id="pEsencial",u.textContent="Protección básica vital.",s.appendChild(p),h.appendChild(i),f.appendChild(u)}else{const e=document.createElement("div");e.id="headerTarifas";const c=document.createElement("h2");c.textContent="Elige tu cobertura ideal",e.appendChild(c);const n=document.createElement("p");n.textContent="Compara los beneficios y selecciona el plan que mejor se adapte a ti.",e.appendChild(n),o.appendChild(e);const a=document.createElement("div");a.id="containerTarifas",o.appendChild(a),l.forEach(r=>{const v={optimo:"Óptimo",premium:"Premium",esencial:"Esencial"},m=L(r.plan),t=document.createElement("div");t.id=`card${m}`,a.appendChild(t);const E=document.createElement("div");E.id=r.plan;const b=document.createElement("h2");b.id=`h2${m}`,b.textContent=`${v[r.plan]}`,E.appendChild(b),t.appendChild(E);const g=document.createElement("div");g.id=`preci${m}`;const P=document.createElement("span");P.textContent=S(r.items[4].value);const T=document.createElement("span");T.textContent=" /año",g.appendChild(P),g.appendChild(T),t.appendChild(g);const x=document.createElement("ul");x.id=`ul${m}`,t.appendChild(x),r.items.forEach(d=>{if(d.label==="Costo anual")return;const $=document.createElement("li");let C=d.value;d.label==="Suma asegurada"&&(C=B(d.value)),d.label==="Deducible"&&(C=`${d.value} UMAM`),d.label==="Coaseguro"&&(C=A(d.value)),d.label==="Tope coaseguro"&&(C=M(d.value)),$.innerHTML=`
                <span class="check_marck"></span>${d.label}: <strong>${C}</strong>
                `,x.appendChild($)});const y=document.createElement("button");y.classList.add("btnPlan"),y.textContent="Seleccionar",y.value=r.plan,t.appendChild(y)});const s=document.getElementById("optimo"),h=document.getElementById("premium"),f=document.getElementById("esencial"),p=document.createElement("p");p.id="pOptimo",p.textContent="Balance costo-beneficio.";const i=document.createElement("p");i.id="pPremium",i.textContent="Máxima protección posible.";const u=document.createElement("p");u.id="pEsencial",u.textContent="Protección básica vital.",s.appendChild(p),h.appendChild(i),f.appendChild(u)}}const S=l=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",maximumFractionDigits:2}).format(l),O="https://wisehealth-api.vercel.app";async function N(l){const e=l.map(t=>({edad:Number(t.age),genero:String(t.gender).trim()})),c=await fetch(`${O}/api/cotizar`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({personas:e})}),a=await(await fetch(`${O}/api/planes`,{method:"GET",headers:{Accept:"application/json"}})).json(),s=await c.json(),h=Array.isArray(s.items)?s.items:[],f=Array.isArray(a.item)?a.item:[],p=new Map(f.map(t=>[t.plan,t])),i=h.map(t=>{const E=p.get(t.plan)||{};return{...t,...E}}),u=new Map(i.map(t=>[t.plan,t])),r=["optimo","premium","esencial"],v=[{label:"Suma asegurada",key:"suma_asegurada",type:"moneda"},{label:"Deducible",key:"deducible",type:"uma"},{label:"Coaseguro",key:"coaseguro",type:"porcentaje"},{label:"Tope coaseguro",key:"tope_coaseguro",type:"moneda"},{label:"Costo anual",key:"total",type:"moneda"}];let m=[];for(let t of r){const E=u.get(t);let b={plan:t,items:[]};for(let g of v)b.items.push({label:g.label,type:g.type,value:E[g.key]});m.push(b)}U(m)}const j="/WiseHealth/".endsWith("/")?"/WiseHealth/":"/WiseHealth//";function w(){const l=localStorage.getItem("list");return l?JSON.parse(l):[]}function H(){if(document.getElementById("tablePeople")){const l=document.getElementById("tableBody");l.innerHTML="";const o=w();if(o.length===0){const e=document.createElement("tr");e.innerHTML=`
      <td colspan="6">No hay personas registradas</td>
      `,l.appendChild(e)}o.forEach(e=>{const c=document.createElement("tr"),n=document.createElement("td"),a=document.createElement("td"),s=document.createElement("td"),h=document.createElement("td"),f=document.createElement("button");f.setAttribute("data-id",`${e.id}`),f.setAttribute("type","button"),n.textContent=`${e.name}`,a.textContent=`${e.age}`,s.textContent=`${e.gender}`,f.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>
      `,c.appendChild(n),c.appendChild(a),c.appendChild(s),h.appendChild(f),c.appendChild(h),l.appendChild(c)}),N(o)}else{document.getElementById("personList").setAttribute("id","personListStyle");const o=document.getElementById("info"),e=document.createElement("div");e.classList.add("headerSection");const c=document.createElement("img");c.src=j+"group.svg",c.alt="group_svg",c.id="group_svg";const n=document.createElement("h2");n.textContent="Personas en tu poliza";const a=document.createElement("table");a.setAttribute("id","tablePeople");const s=document.createElement("thead"),h=document.createElement("tbody");h.setAttribute("id","tableBody"),a.appendChild(s),a.appendChild(h),h.addEventListener("click",p=>{const i=p.target.closest("button");if(i){let u=i.dataset.id;k(u)}}),s.innerHTML=`
    <tr>
      <th>Nombre</th>
      <th>Edad</th>
      <th>Género</th>
      <th>Eliminar</th>
    </tr>
    `;const f=w();f.forEach(p=>{const i=document.createElement("tr"),u=document.createElement("td"),r=document.createElement("td"),v=document.createElement("td"),m=document.createElement("td"),t=document.createElement("button");t.setAttribute("data-id",`${p.id}`),t.setAttribute("type","button"),u.textContent=`${p.name}`,r.textContent=`${p.age}`,v.textContent=`${p.gender}`,t.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>
      `,i.appendChild(u),i.appendChild(r),i.appendChild(v),m.appendChild(t),i.appendChild(m),h.appendChild(i)}),e.appendChild(c),e.appendChild(n),o.appendChild(e),o.appendChild(a),N(f)}}const D=document.getElementById("buttonForm");class I{constructor(o,e,c){this.id=I.#e++,this.name=o,this.age=e,this.gender=c}static#e=Date.now()}D.addEventListener("click",l=>{l.preventDefault();let o=w(),e=document.forms.newPerson,c=e.name.value,n=e.age.value,a=e.gender.value;e.reportValidity()&&(o.push(new I(c,n,a)),localStorage.setItem("list",JSON.stringify(o)),e.reset()),H()});
