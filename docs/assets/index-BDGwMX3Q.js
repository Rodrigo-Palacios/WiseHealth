(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function e(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(t){if(t.ep)return;t.ep=!0;const n=e(t);fetch(t.href,n)}})();function q(l){let a=parseInt(l);const e=I();console.log(a);let c=e.findIndex(t=>t.id===a);e.splice(c,1),localStorage.setItem("list",JSON.stringify(e)),U()}function L(l){let a=l.slice(0,1).toUpperCase(),e=l.slice(1);return`${a}${e}`}function w(l){return`$${l/1e6}M`}function A(l){return`${l*100}%`}function M(l){return`$${l/1e3}K`}const P={selectedPlan:!1,containerPlan:null,ulCheck:null,btnClick:null};function k(){document.getElementById("containerTarifas").addEventListener("click",a=>{const e=a.target.closest("button");if(!e){console.log(e);return}console.log(e);const c=a.target.dataset.planId,t=`card${L(c)}`,n=`ul${L(c)}`,i=document.querySelector(`.btn${c}`),u=document.querySelector(`.${t}`),p=document.getElementById(`${n}`).querySelectorAll("span");if(P.selectedPlan){document.querySelector(`.${P.containerPlan}`).classList.remove("cardSelected"),document.getElementById(`${P.ulCheck}`).querySelectorAll("span").forEach(m=>{m.classList.remove("checkSelected")});const C=document.querySelector(`${P.btnClick}`);C.textContent="Seleccionar",C.classList.remove("btnSelected")}u.classList.add("cardSelected"),P.containerPlan=t,P.ulCheck=n,p.forEach(d=>{d.classList.add("checkSelected")}),i.textContent="Seleccionado",i.classList.add("btnSelected"),P.btnClick=`.btn${c}`,P.selectedPlan=!0})}new URL("./assets/check_green.svg",import.meta.url).href;function j(l){const a=document.getElementById("tarifas");if(document.getElementById("headerTarifas")){document.getElementById("tarifas").textContent="";const e=document.createElement("div");e.id="headerTarifas";const c=document.createElement("h2");c.textContent="Elige tu cobertura ideal",e.appendChild(c);const t=document.createElement("p");t.textContent="Compara los beneficios y selecciona el plan que mejor se adapte a ti.",e.appendChild(t),a.appendChild(e);const n=document.createElement("div");n.id="containerTarifas",a.appendChild(n),l.forEach(r=>{const C={optimo:"Óptimo",premium:"Premium",esencial:"Esencial"},m=L(r.plan),o=document.createElement("div");o.classList.add(`card${m}`),n.appendChild(o);const E=document.createElement("div");E.id=r.plan;const y=document.createElement("h2");y.id=`h2${m}`,y.textContent=`${C[r.plan]}`,E.appendChild(y),o.appendChild(E);const g=document.createElement("div");g.id=`preci${m}`;const $=document.createElement("span");$.textContent=O(r.items[4].value);const S=document.createElement("span");S.textContent=" /año",g.appendChild($),g.appendChild(S),o.appendChild(g);const x=document.createElement("ul");x.id=`ul${m}`,o.appendChild(x),r.items.forEach(s=>{if(s.label==="Costo anual")return;const T=document.createElement("li");let b=s.value;s.label==="Suma asegurada"&&(b=w(s.value)),s.label==="Deducible"&&(b=`${s.value} UMAM`),s.label==="Coaseguro"&&(b=A(s.value)),s.label==="Tope coaseguro"&&(b=M(s.value)),T.innerHTML=`
                <span class="check_marck"></span>${s.label}: <strong>${b}</strong>
                `,x.appendChild(T)});const v=document.createElement("button");v.classList.add("btnPlan"),v.classList.add(`btn${r.plan}`),v.dataset.planId=r.plan,v.textContent="Seleccionar",o.appendChild(v)});const i=document.getElementById("optimo"),u=document.getElementById("premium"),f=document.getElementById("esencial"),p=document.createElement("p");p.id="pOptimo",p.textContent="Balance costo-beneficio.";const d=document.createElement("p");d.id="pPremium",d.textContent="Máxima protección posible.";const h=document.createElement("p");h.id="pEsencial",h.textContent="Protección básica vital.",i.appendChild(p),u.appendChild(d),f.appendChild(h),k()}else{const e=document.createElement("div");e.id="headerTarifas";const c=document.createElement("h2");c.textContent="Elige tu cobertura ideal",e.appendChild(c);const t=document.createElement("p");t.textContent="Compara los beneficios y selecciona el plan que mejor se adapte a ti.",e.appendChild(t),a.appendChild(e);const n=document.createElement("div");n.id="containerTarifas",a.appendChild(n),l.forEach(r=>{const C={optimo:"Óptimo",premium:"Premium",esencial:"Esencial"},m=L(r.plan),o=document.createElement("div");o.classList.add(`card${m}`),n.appendChild(o);const E=document.createElement("div");E.id=r.plan;const y=document.createElement("h2");y.id=`h2${m}`,y.textContent=`${C[r.plan]}`,E.appendChild(y),o.appendChild(E);const g=document.createElement("div");g.id=`preci${m}`;const $=document.createElement("span");$.textContent=O(r.items[4].value);const S=document.createElement("span");S.textContent=" /año",g.appendChild($),g.appendChild(S),o.appendChild(g);const x=document.createElement("ul");x.id=`ul${m}`,o.appendChild(x),r.items.forEach(s=>{if(s.label==="Costo anual")return;const T=document.createElement("li");let b=s.value;s.label==="Suma asegurada"&&(b=w(s.value)),s.label==="Deducible"&&(b=`${s.value} UMAM`),s.label==="Coaseguro"&&(b=A(s.value)),s.label==="Tope coaseguro"&&(b=M(s.value)),T.innerHTML=`
                <span class="check_marck"></span>${s.label}: <strong>${b}</strong>
                `,x.appendChild(T)});const v=document.createElement("button");v.classList.add(`btn${r.plan}`),v.dataset.planId=r.plan,v.textContent="Seleccionar",o.appendChild(v)});const i=document.getElementById("optimo"),u=document.getElementById("premium"),f=document.getElementById("esencial"),p=document.createElement("p");p.id="pOptimo",p.textContent="Balance costo-beneficio.";const d=document.createElement("p");d.id="pPremium",d.textContent="Máxima protección posible.";const h=document.createElement("p");h.id="pEsencial",h.textContent="Protección básica vital.",i.appendChild(p),u.appendChild(d),f.appendChild(h),k()}}const O=l=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",maximumFractionDigits:2}).format(l),N="https://wisehealth-api.vercel.app";async function H(l){const e=l.map(o=>({edad:Number(o.age),genero:String(o.gender).trim()})),c=await fetch(`${N}/api/cotizar`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({personas:e})}),n=await(await fetch(`${N}/api/planes`,{method:"GET",headers:{Accept:"application/json"}})).json(),i=await c.json(),u=Array.isArray(i.items)?i.items:[],f=Array.isArray(n.item)?n.item:[],p=new Map(f.map(o=>[o.plan,o])),d=u.map(o=>{const E=p.get(o.plan)||{};return{...o,...E}}),h=new Map(d.map(o=>[o.plan,o])),r=["optimo","premium","esencial"],C=[{label:"Suma asegurada",key:"suma_asegurada",type:"moneda"},{label:"Deducible",key:"deducible",type:"uma"},{label:"Coaseguro",key:"coaseguro",type:"porcentaje"},{label:"Tope coaseguro",key:"tope_coaseguro",type:"moneda"},{label:"Costo anual",key:"total",type:"moneda"}];let m=[];for(let o of r){const E=h.get(o);let y={plan:o,items:[]};for(let g of C)y.items.push({label:g.label,type:g.type,value:E[g.key]});m.push(y)}j(m)}const D="/WiseHealth/".endsWith("/")?"/WiseHealth/":"/WiseHealth//";function I(){const l=localStorage.getItem("list");return l?JSON.parse(l):[]}function U(){if(document.getElementById("tablePeople")){const l=document.getElementById("tableBody");l.innerHTML="";const a=I();if(a.length===0){const e=document.createElement("tr");e.innerHTML=`
      <td colspan="6">No hay personas registradas</td>
      `,l.appendChild(e)}a.forEach(e=>{const c=document.createElement("tr"),t=document.createElement("td"),n=document.createElement("td"),i=document.createElement("td"),u=document.createElement("td"),f=document.createElement("button");f.setAttribute("data-id",`${e.id}`),f.setAttribute("type","button"),t.textContent=`${e.name}`,n.textContent=`${e.age}`,i.textContent=`${e.gender}`,f.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>
      `,c.appendChild(t),c.appendChild(n),c.appendChild(i),u.appendChild(f),c.appendChild(u),l.appendChild(c)}),H(a)}else{document.getElementById("personList").setAttribute("id","personListStyle");const a=document.getElementById("info"),e=document.createElement("div");e.classList.add("headerSection");const c=document.createElement("img");c.src=D+"group.svg",c.alt="group_svg",c.id="group_svg";const t=document.createElement("h2");t.textContent="Personas en tu poliza";const n=document.createElement("table");n.setAttribute("id","tablePeople");const i=document.createElement("thead"),u=document.createElement("tbody");u.setAttribute("id","tableBody"),n.appendChild(i),n.appendChild(u),u.addEventListener("click",p=>{const d=p.target.closest("button");if(d){let h=d.dataset.id;q(h)}}),i.innerHTML=`
    <tr>
      <th>Nombre</th>
      <th>Edad</th>
      <th>Género</th>
      <th>Eliminar</th>
    </tr>
    `;const f=I();f.forEach(p=>{const d=document.createElement("tr"),h=document.createElement("td"),r=document.createElement("td"),C=document.createElement("td"),m=document.createElement("td"),o=document.createElement("button");o.setAttribute("data-id",`${p.id}`),o.setAttribute("type","button"),h.textContent=`${p.name}`,r.textContent=`${p.age}`,C.textContent=`${p.gender}`,o.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>
      `,d.appendChild(h),d.appendChild(r),d.appendChild(C),m.appendChild(o),d.appendChild(m),u.appendChild(d)}),e.appendChild(c),e.appendChild(t),a.appendChild(e),a.appendChild(n),H(f)}}const _=document.getElementById("buttonForm");class B{constructor(a,e,c){this.id=B.#e++,this.name=a,this.age=e,this.gender=c}static#e=Date.now()}_.addEventListener("click",l=>{l.preventDefault();let a=I(),e=document.forms.newPerson,c=e.name.value,t=e.age.value,n=e.gender.value;e.reportValidity()&&(a.push(new B(c,t,n)),localStorage.setItem("list",JSON.stringify(a)),e.reset()),U()});
