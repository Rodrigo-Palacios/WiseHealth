(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function t(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(e){if(e.ep)return;e.ep=!0;const n=t(e);fetch(e.href,n)}})();function w(r){let a=parseInt(r);const t=b();console.log(a);let o=t.findIndex(e=>e.id===a);t.splice(o,1),localStorage.setItem("list",JSON.stringify(t)),A()}function L(r){const a=document.getElementById("tarifas");if(document.getElementById("tableTarifas")){a.textContent="";const t=document.createElement("table");t.setAttribute("id","tableTarifas"),a.appendChild(t);const o=document.createElement("thead");o.innerHTML=`
        <tr>
            <th></th>
            <th>Otimo</th>
            <th>Premium</th>
            <th>Esencial</th>
        </tr>
        `,t.appendChild(o),r.rows.forEach(e=>{const n=document.createElement("tbody"),s=document.createElement("tr");s.textContent=e.label;for(const c of e.values){const i=document.createElement("td");let l="";e.type==="moneda"?l=C(c):e.type==="uma"?l=c+" UMAM":(e.type="porcentaje")?l=c*100+"%":l="_",i.textContent=l,s.appendChild(i),console.log(l)}n.appendChild(s),t.appendChild(n),console.log(e)})}else{const t=document.createElement("table");t.setAttribute("id","tableTarifas"),a.appendChild(t);const o=document.createElement("thead");o.innerHTML=`
        <tr>
            <th></th>
            <th>Otimo</th>
            <th>Premium</th>
            <th>Esencial</th>
        </tr>
        `,t.appendChild(o),r.rows.forEach(e=>{const n=document.createElement("tbody"),s=document.createElement("tr");s.textContent=e.label;for(const c of e.values){const i=document.createElement("td");let l="";e.type==="moneda"?l=C(c):e.type==="uma"?l=c+" UMAM":(e.type="porcentaje")?l=c*100+"%":l="_",i.textContent=l,s.appendChild(i),console.log(l)}n.appendChild(s),t.appendChild(n),console.log(e)})}console.log(r)}const C=r=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",maximumFractionDigits:2}).format(r),v="https://wisehealth-api.vercel.app";async function x(r){const t=r.map(d=>({edad:Number(d.age),genero:String(d.gender).trim()})),o=await fetch(`${v}/api/cotizar`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({personas:t})}),n=await(await fetch(`${v}/api/planes`,{method:"GET",headers:{Accept:"application/json"}})).json(),s=await o.json(),c=Array.isArray(s.items)?s.items:[],i=Array.isArray(n.item)?n.item:[],l=new Map(i.map(d=>[d.plan,d])),p=c.map(d=>{const g=l.get(d.plan)||{};return{...d,...g}}),m=["optimo","premium","esencial"],f=[{label:"Suma asegurada",key:"suma_asegurada",type:"moneda"},{label:"Deducible",key:"deducible",type:"uma"},{label:"Coaseguro",key:"coaseguro",type:"porcentaje"},{label:"Tope coaseguro",key:"tope_coaseguro",type:"moneda"},{label:"Costo anual",key:"total",type:"moneda"}],h={};for(const d of p)h[d.plan]=d;const u={columns:m,rows:[]};for(const d of f){const g=[];for(const P of m){const E=h[P],T=E?E[d.key]:null;g.push(T)}u.rows.push({label:d.label,type:d.type,values:g})}console.log(u),L(u)}function b(){const r=localStorage.getItem("list");return r?JSON.parse(r):[]}function A(){if(document.getElementById("tablePeople")){const r=document.getElementById("tableBody");r.innerHTML="";const a=b();if(a.length===0){const t=document.createElement("tr");t.innerHTML=`
      <td colspan="6">No hay personas registradas</td>
      `,r.appendChild(t)}a.forEach(t=>{const o=document.createElement("tr"),e=document.createElement("td"),n=document.createElement("td"),s=document.createElement("td"),c=document.createElement("td"),i=document.createElement("button");i.setAttribute("data-id",`${t.id}`),i.setAttribute("type","button"),e.textContent=`${t.name}`,n.textContent=`${t.age}`,s.textContent=`${t.gender}`,i.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>
      `,o.appendChild(e),o.appendChild(n),o.appendChild(s),c.appendChild(i),o.appendChild(c),r.appendChild(o)}),x(a)}else{document.getElementById("personList").setAttribute("id","personListStyle");const a=document.getElementById("info"),t=document.createElement("div");t.classList.add("headerSection");const o=document.createElement("img");o.setAttribute("src","./public/group.svg"),o.setAttribute("alt","group_svg"),o.setAttribute("id","group_svg");const e=document.createElement("h1");e.textContent="Personas en tu poliza";const n=document.createElement("table");n.setAttribute("id","tablePeople");const s=document.createElement("thead"),c=document.createElement("tbody");c.setAttribute("id","tableBody"),n.appendChild(s),n.appendChild(c),c.addEventListener("click",l=>{const p=l.target.closest("button");if(p){let m=p.dataset.id;w(m)}}),s.innerHTML=`
    <tr>
      <th>Nombre</th>
      <th>Edad</th>
      <th>GÃ©nero</th>
      <th>Eliminar</th>
    </tr>
    `;const i=b();i.forEach(l=>{const p=document.createElement("tr"),m=document.createElement("td"),f=document.createElement("td"),h=document.createElement("td"),u=document.createElement("td"),d=document.createElement("button");d.setAttribute("data-id",`${l.id}`),d.setAttribute("type","button"),m.textContent=`${l.name}`,f.textContent=`${l.age}`,h.textContent=`${l.gender}`,d.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>
      `,p.appendChild(m),p.appendChild(f),p.appendChild(h),u.appendChild(d),p.appendChild(u),c.appendChild(p)}),t.appendChild(o),t.appendChild(e),a.appendChild(t),a.appendChild(n),x(i)}}const I=document.getElementById("buttonForm");class y{constructor(a,t,o){this.id=y.#e,this.name=a,this.age=t,this.gender=o}static#e=Date.now()}I.addEventListener("click",r=>{r.preventDefault();let a=b(),t=document.forms.newPerson,o=t.name.value,e=t.age.value,n=t.gender.value;t.reportValidity()&&(a.push(new y(o,e,n)),localStorage.setItem("list",JSON.stringify(a)),t.reset()),A()});
